# README: Сбор статистики KPSS CNTS

## Описание
Этот скрипт предназначен для сбора статистики и формирования отчетов на основе входных Excel-файлов. Он выполняет следующие задачи:
1. Проверяет корректность входного файла
2. Создает два промежуточных файла с распознанными и верифицированными значениями
3. Генерирует итоговый отчет о качестве распознавания

## Требования
- Python 3.x
- Установленные зависимости (указаны в requirements.txt)

## Установка
1. Склонируйте репозиторий
2. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```

## Использование
Запустите скрипт командой:
```
python main.py
```

## Входные данные
Вход 
DATA_PATH / INPUT
На Выход 
DATA_PATH / OUTPUT
DATA_PATH / OUTPUT / INPUT_DATA_FORMAT_CSV
DATA_PATH / OUTPUT / INPUT_DATA_FORMAT_XLSX
DATA_PATH / OUTPUT / REPORTS
DATA_PATH / OUTPUT / AUXILIARY_FILES

На вход подается папка с 5-ю файлами формата csv (INPUT)
Файлы форматируются в формат .xlsx и сохраняются в новую папку (OUTPUT)
Нужно убрать из проверки поле название класса, и брать его из названия файла + дату тоже брать из навания файла исходника
Скрипт перебирает каждый файл и создает отчет и два вспомогательных файла
Скрипт ожидает входной файл по пути, указанному в `INPUT_FILE_PATH` (константа из файла constants.py). Файл должен соответствовать определенному формату, который проверяется функцией `check_excel()`.

## Выходные данные
Скрипт генерирует три файла:
1. Файл с распознанными значениями (на основе DOCUMENT_INPUT_REQUEST)
2. Файл с верифицированными значениями (на основе DOCUMENT_VERIFICATION_REQUEST)
3. Отчет о качестве распознавания

## Логирование
Все действия скрипта логируются:
- В консоль (stdout)
- В файл `main.py.log` в той же директории

Уровни логирования:
- INFO: Основные этапы работы
- DEBUG: Детальная информация
- CRITICAL: Критические ошибки

## Обработка ошибок
При обнаружении ошибок во входных данных скрипт:
1. Записывает критическое сообщение в лог
2. Вызывает исключение CheckError с описанием проблемы

## Константы
Основные константы хранятся в файле constants.py:
- INPUT_FILE_PATH - путь к входному файлу
- DOCUMENT_INPUT_REQUEST - параметры для запроса распознанных значений
- DOCUMENT_VERIFICATION_REQUEST - параметры для запроса верифицированных значений
- INPUT_DATA_COLUMN_NAME - название колонки с входными данными
- OUTPUT_DATA_COLUMN_NAME - название колонки с выходными данными

## Структура кода
Основные функции:
- `counting_statistics_kpss_cnts()` - главная функция, координирующая процесс
- `check_excel()` - проверка входного файла
- `convert_json_to_excel()` - конвертация данных в Excel
- `create_report()` - создание итогового отчета